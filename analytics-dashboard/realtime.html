<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ AI Bug Router - Real-time Monitor</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        .monitor {
            max-width: 800px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .status-card {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid #4CAF50;
        }
        .status-card.warning { border-left-color: #ff9800; }
        .status-card.error { border-left-color: #f44336; }
        .status-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .status-label {
            color: #aaa;
            font-size: 0.9rem;
        }
        .log-container {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 20px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        .log-timestamp {
            color: #666;
        }
        .log-success { color: #4CAF50; }
        .log-warning { color: #ff9800; }
        .log-error { color: #f44336; }
    </style>
</head>
<body>
    <div class="monitor">
        <div class="header">
            <h1>ü§ñ AI Bug Router - Real-time Monitor</h1>
            <p id="lastUpdate">Last update: Loading...</p>
        </div>
        
        <div class="status-grid">
            <div class="status-card">
                <div class="status-value" id="systemStatus">‚óè</div>
                <div class="status-label">System Status</div>
            </div>
            <div class="status-card">
                <div class="status-value" id="todayRoutes">0</div>
                <div class="status-label">Routes Today</div>
            </div>
            <div class="status-card">
                <div class="status-value" id="successRate">0%</div>
                <div class="status-label">Success Rate</div>
            </div>
            <div class="status-card">
                <div class="status-value" id="activeIssues">0</div>
                <div class="status-label">Active Issues</div>
            </div>
        </div>
        
        <div class="log-container" id="logContainer">
            <div class="log-entry">
                <span class="log-timestamp">[14.16.08]</span>
                <span class="log-success">Real-time monitor initialized</span>
            </div>
        </div>
    </div>

    <script>
        let logEntries = [];
        
        function updateStatus() {
            fetch('./latest.json')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('lastUpdate').textContent = 
                        'Last update: ' + new Date(data.timestamp).toLocaleString();
                    
                    document.getElementById('todayRoutes').textContent = data.routing.totalRoutingEvents;
                    document.getElementById('successRate').textContent = data.routing.accuracyScore + '%';
                    document.getElementById('activeIssues').textContent = data.github.openIssues;
                    
                    const systemStatus = document.getElementById('systemStatus');
                    if (data.summary.overallHealth === 'good') {
                        systemStatus.textContent = '‚óè';
                        systemStatus.style.color = '#4CAF50';
                    } else if (data.summary.overallHealth === 'warning') {
                        systemStatus.textContent = '‚óè';
                        systemStatus.style.color = '#ff9800';
                    } else {
                        systemStatus.textContent = '‚óè';
                        systemStatus.style.color = '#f44336';
                    }
                    
                    addLogEntry('System status updated', 'success');
                })
                .catch(error => {
                    addLogEntry('Failed to fetch data: ' + error.message, 'error');
                });
        }
        
        function addLogEntry(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = 
                '<span class="log-timestamp">[' + timestamp + ']</span> ' +
                '<span class="log-' + type + '">' + message + '</span>';
            
            const container = document.getElementById('logContainer');
            container.appendChild(entry);
            container.scrollTop = container.scrollHeight;
            
            // Keep only last 50 entries
            while (container.children.length > 50) {
                container.removeChild(container.firstChild);
            }
        }
        
        // Update every 30 seconds
        updateStatus();
        setInterval(updateStatus, 30000);
        
        // Add some demo activity
        setInterval(() => {
            const activities = [
                { msg: 'Scanning repositories for new issues', type: 'info' },
                { msg: 'AI routing accuracy: 94.2%', type: 'success' },
                { msg: 'GitHub API rate limit: OK', type: 'success' },
                { msg: 'ClickUp sync completed', type: 'success' }
            ];
            
            const activity = activities[Math.floor(Math.random() * activities.length)];
            addLogEntry(activity.msg, activity.type);
        }, 10000);
    </script>
</body>
</html>